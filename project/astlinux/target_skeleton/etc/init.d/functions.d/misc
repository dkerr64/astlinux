#
# Function include file for init.d/ 
#
# Miscellaneous Tools
#
# Convention, begin included functions with SYS_
# SYS_function_name()
#

SYS_gen_etc_hosts() {
  local ip IFS dd_host

  echo "# Automatically generated from internal state.
127.0.0.1	localhost"

  if [ "$IPV6" = "yes" ]; then
    echo "
::1	localhost ip6-localhost ip6-loopback
"
  fi

  # DDHOST may not be a pure DNS Name, purify it
  dd_host="$(echo "$DDHOST" | sed 's/[, ].*//')"
  if [ -n "$dd_host" ] && [ "$dd_host" != "$HOSTNAME.$DOMAIN" ]; then
    # only add DDHOST if it is not he same as my hostname.domain so we
    # don't duplicate DNS record added by dnsmasq.
    echo "$INTIP	$dd_host"
  fi

  if [ -f /stat/etc/hosts ]; then
    echo ""
    cat /stat/etc/hosts
  fi

  if [ -f /mnt/kd/hosts ]; then
    echo ""
    cat /mnt/kd/hosts
  fi

  if [ -n "$STATICHOSTS" ]; then

    echo "
# generated from STATICHOSTS in rc.conf"

    IFS=$'\n'
    for i in $STATICHOSTS; do
      echo "$i" | awk -F~ '{ print $2 "\t" $1 ($4 == "" ? "" : "\t# "$4); }'
    done
  fi
}

SYS_is_vpn_type()
{
  # args: vpn_type
  local vpn IFS

  unset IFS
  for vpn in $VPN; do
    if [ "$vpn" = "$1" ]; then
      return 0
    fi
  done

  return 1
}

